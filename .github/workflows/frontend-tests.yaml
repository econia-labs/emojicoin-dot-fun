---
jobs:
  playwright-tests:
    defaults:
      run:
        working-directory: 'src/typescript'
    runs-on: 'ubuntu-latest'
    steps:
    - uses: 'actions/checkout@v4'
    - uses: 'actions/setup-node@v4'
      with:
        node-version: 'lts/*'
    - name: 'Install dependencies'
      run: 'npm install -g pnpm && pnpm install'
    - env:
        GITHUB_ACCESS_TOKEN: '${{ secrets.TRADING_VIEW_REPO_ACCESS_TOKEN }}'
        TRADING_VIEW_REPO_OWNER: '${{ secrets.TRADING_VIEW_REPO_OWNER }}'
      name: 'Test'
      run: 'echo -n $TRADING_VIEW_REPO_OWNER | wc -c'
    - env:
        GITHUB_ACCESS_TOKEN: '${{ secrets.TRADING_VIEW_REPO_ACCESS_TOKEN }}'
        TRADING_VIEW_REPO_OWNER: '${{ secrets.TRADING_VIEW_REPO_OWNER }}'
      name: 'Clone submodule'
      run: 'pnpm run submodule'
    - name: 'Run pnpm i'
      run: 'pnpm i'
    - name: 'Install Playwright Browsers'
      run: 'pnpm run playwright:install'
    - name: 'Copy env file'
      run: 'cp ci.env .env'
    - name: 'Copy docker env file'
      run: 'cp ../docker/example.local.env ../docker/.env'
    - name: 'Run Playwright tests'
      run: 'pnpm run e2e:frontend'
    - if: 'always()'
      uses: 'actions/upload-artifact@v4'
      with:
        name: 'playwright-report'
        path: 'playwright-report/'
        retention-days: 30
    timeout-minutes: 60
name: 'Run the frontend tests'
"on":
  pull_request:
    branches:
    - 'main'
    - 'production'
  push:
    branches:
    - 'main'
    - 'production'
...
