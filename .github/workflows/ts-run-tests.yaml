---
env:
  NEXT_PUBLIC_MODULE_ADDRESS: |-
    0xf000000d12c21b4170c7165010a4373b9ebc47bb9be9f0e48091645308a14136
  PUBLISHER_PK: |-
    0xb2e21f041ace3b049de2ef720ba6d1e1e9601c72d0d79efcbf6c476437174f10
  TS_DIR: 'src/typescript'
jobs:
  ts-run-tests:
    runs-on: 'ubuntu-latest'
    steps:
    - uses: 'actions/checkout@v3'
      with:
        submodules: 'false'
    - run: |
        git submodule update --init --recursive src/rust
        cp src/docker/example.local.env src/docker/.env && \
        bash src/sh/emojicoin/test-runner.sh \
        --remove \
        --start \
        --no-frontend \
        --compile
      shell: 'bash'
    - uses: './.github/actions/ts-run-tests'

    # Add a tmate debugging session if the previous step fails.
    - name: Setup tmate session
      uses: mxschmitt/action-tmate@v3
      if: failure()
      with:
        limit-access-to-actor: true

    # Add a manual trigger for a tmate session.
    - name: Setup tmate session (manual trigger)
      uses: mxschmitt/action-tmate@v3
      if: github.event_name == 'workflow_dispatch'
      with:
        limit-access-to-actor: true

name: 'Run the TypeScript E2E and unit tests with a local testnet'
'on':
  pull_request: null
  push:
    branches:
    - 'main'
    - 'production'
  workflow_dispatch: null
...
